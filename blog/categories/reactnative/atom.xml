<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Category: Reactnative | Balloonsys Inc.]]></title>
  <link href="https://linkoubian.github.io/blog/categories/reactnative/atom.xml" rel="self"/>
  <link href="https://linkoubian.github.io/"/>
  <updated>2019-05-27T22:22:45+08:00</updated>
  <id>https://linkoubian.github.io/</id>
  <author>
    <name><![CDATA[Linkou Bian]]></name>
    
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[React Native é¡¹ç›®å®æˆ˜]]></title>
    <link href="https://linkoubian.github.io/blog/2016/10/18/rn-put-it-all-together/"/>
    <updated>2016-10-18T15:02:29+08:00</updated>
    <id>https://linkoubian.github.io/blog/2016/10/18/rn-put-it-all-together</id>
    <content type="html"><![CDATA[<p>æœ¬æ–‡ä»¥ Twitter å·¥ç¨‹å¸ˆ Bonnie Eisenman æ’°å†™çš„ Learning React Native ä¸€ä¹¦çš„ç¬¬ä¹ç« å†…å®¹ä¸ºè“æœ¬ï¼Œæ€»ç»“äº† React Native é¡¹ç›®å®è·µçš„ä¸€äº›ç»éªŒã€‚</p>

<!--more-->


<h2>é¡¹ç›®ç»„ç»‡ç»“æ„</h2>

<p>æ‰€æœ‰çš„æ–°å¢æ–‡ä»¶å‡æ”¾åœ¨é¡¹ç›®æ ¹ç›®å½•ä¸‹çš„ src é‡Œï¼Œä¸»è¦æœ‰åŒ…å«å„é¡µé¢çš„ components å­ç›®å½•ã€æ•°æ®æ¨¡å‹çš„ data å­ç›®å½•ã€è´Ÿè´£æ•°æ®å­˜å–çš„ stores å­ç›®å½•ã€å…¬å…±æ ·å¼å®šä¹‰ styles å­ç›®å½•ã€å­˜æ”¾èµ„æºå›¾ç‰‡ç­‰çš„ resources å­ç›®å½•ç­‰ã€‚</p>

<p><img src="https://c2.staticflickr.com/6/5781/30365572286_b0c35d2176_o.png" width="226" alt="RN Project Structure" /></p>

<p>index.ios.js æ˜¯ Native åº”ç”¨çš„å…¥å£ï¼Œè¯¥æ–‡ä»¶å°½é‡ç®€æ´ï¼ŒæŒ‡å‘ RN é¡¹ç›®é‡Œè´Ÿè´£é¡µé¢è·³è½¬çš„ä¸»æ–‡ä»¶ components/Zebreto.jsã€‚</p>

<h2>æ¡ˆä¾‹é¡¹ç›®ç®€ä»‹</h2>

<p>ä½œè€…æä¾›çš„ç¤ºä¾‹é¡¹ç›®åŒ…å«ä¸‰ä¸ªé¡µé¢ï¼ŒåŒ…å«å¤šå‰¯ç‰Œï¼ˆDeckï¼‰çš„åˆ—è¡¨é¡µã€ä¸ºé€‰ä¸­çš„æŸå‰¯ç‰Œå¢åŠ ä¸€å¼ å¡ç‰Œï¼ˆCardï¼‰çš„é¡µé¢ã€ä¸ºæŸå¼ å¡ç‰Œé€‰æ‹©ç­”æ¡ˆï¼ˆReviewï¼‰çš„é¡µé¢ã€‚</p>

<p>åœ¨åˆ—è¡¨é¡µç‚¹å‡» Create Deck æŒ‰é’®ï¼ŒæŒ‰é’®ä¸Šæ–¹å‡ºç°è¾“å…¥æ¡†ï¼Œå¡«å†™å†…å®¹ä½œä¸º Deck çš„åç§°ã€‚ç‚¹å‡» Deck å³ä¾§æŒ‰é’®åˆ™è¿›å…¥å¢åŠ å¡ç‰Œé¡µé¢ï¼Œç‚¹å‡» Deck å·¦ä¾§åˆ™è¿›å…¥ Review çš„é¡µé¢ã€‚</p>

<h2>æ„å»ºåŸºç¡€ç»„ä»¶</h2>

<h3>å…¬å…±æ ·å¼</h3>

<p>å…¨å±€çš„é¢œè‰²ã€å­—å·ç­‰ï¼Œå¯ä»¥åœ¨ js é‡Œç›´æ¥å®šä¹‰å­—å…¸æ•°æ®ç»“æ„ï¼Œç„¶å exports ä»¥ä¾›å¤–ç•Œè®¿é—®ã€‚æ¯”å¦‚ï¼š</p>

<pre><code class="js">var palette = {
  pink: '#FDA6CD'
};

module.exports = palette;
</code></pre>

<p>æ‰€ä»¥ï¼Œåƒå¹³å®‰å¥½æˆ¿çš„åº”ç”¨å¯ä»¥å‚ç…§ä¸Šè¿°ç»“æ„å®šä¹‰ pa_orange ç­‰è‰²å€¼ã€‚å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥åœ¨ä¸€ä¸ª js æ–‡ä»¶é‡Œå®šä¹‰å¤šä¸ªå­—å…¸ï¼Œç„¶å exports æ—¶å°†ä»–ä»¬åŒ…å«åœ¨èŠ±æ‹¬å·ä¸­å³å¯ã€‚</p>

<pre><code class="js">module.exports = {fonts, color};
</code></pre>

<p>åœ¨ä½¿ç”¨ä¸Šè¿°ç»“æ„æ—¶ï¼Œå°±éœ€è¦è¿™ä¹ˆ import äº†ï¼š</p>

<pre><code class="js">import { fonts, color } from '&lt;PATH-OF-FILE&gt;';
</code></pre>

<h3>å…¬å…±ç»„ä»¶</h3>

<p>æˆ‘ä»¬ä¸ç›´æ¥ç”¨ Text ç»„ä»¶ï¼Œè€Œæ˜¯åŒ…è£…æˆ HeadingText å’Œ NormalText ä¾›é¡¹ç›®é‡Œçš„ä¸åŒé¡µé¢ä½¿ç”¨ã€‚åŒæ ·çš„ï¼Œä¸ºäº†ä»£ç é‡ç”¨ä¸ä½¿ç”¨ä¾¿æ·ï¼Œæˆ‘ä»¬å°è£… Buttonã€Inputã€LabeldInput ç­‰ç»„ä»¶ã€‚</p>

<p>å…¶ä¸­ Button ç»„ä»¶æ„å»ºåœ¨ TouchableOpacity åŸºç¡€ä¹‹ä¸Šï¼Œæ”¯æŒ func ç±»å‹çš„å±æ€§ä»¥åœ¨ç‚¹å‡»æ—¶è°ƒç”¨ä½¿ç”¨æ–¹çš„æ–¹æ³•ï¼Œä¹Ÿæ”¯æŒ View.propTypes.style ç±»å‹çš„å±æ€§ä»¥æ–¹ä¾¿å®šåˆ¶å…¶æ ·å¼ç­‰ã€‚</p>

<p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œä¸ºäº†è®© Button ç»„ä»¶èƒ½åŒ…å«å…¶ä»–å­ç»„ä»¶ï¼Œæˆ‘ä»¬ä½¿ç”¨äº†ä¸€ä¸ª object ç±»å‹çš„å±æ€§ï¼Œç„¶ååœ¨ render æ—¶è¾“å‡º children å³å¯ã€‚</p>

<p>HeadingText å’Œ NormalText å»ºç«‹åœ¨ Text ç»„ä»¶ä¹‹ä¸Šï¼Œè‡ªå®šä¹‰æ ·å¼æ˜¯é€šè¿‡ Text.propTypes.style ç±»å‹çš„å±æ€§æ”¯æŒçš„ã€‚æ³¨æ„æ­¤å¤„ç±»å‹ä¸åŒäºå‰é¢ Button ä½¿ç”¨è¿‡çš„æ ·å¼ç±»å‹ã€‚</p>

<p>Input ç»„ä»¶å»ºç«‹åœ¨ TextInput ä¹‹ä¸Šï¼ŒLabeledInput ç»„åˆäº† Input å’Œ NormalText ä¸¤ä¸ªç»„ä»¶ï¼Œä½“ç°äº†å¤ç”¨çš„ç†å¿µã€‚</p>

<h2>é¡µé¢å¼€å‘</h2>

<h3>Deck åˆ—è¡¨é¡µ</h3>

<h4>æ•°æ®å»ºæ¨¡</h4>

<p>åœ¨ React Native é¡¹ç›®è¯•ç‚¹è¿‡ç¨‹ä¸­ï¼Œå°šä¸ç†Ÿæ‚‰ JavaScript çš„ç±»ç›¸å…³è¯­æ³•ã€‚å½“æ—¶éƒ½æ˜¯ç”¨çš„å­—å…¸:[</p>

<pre><code class="js">class Deck {
  constructor() {
  }
}

module.exports = Deck;
</code></pre>

<p>æ•°æ®åœ¨æœ¬åœ°ä½¿ç”¨ AsyncStorage å­˜å–ï¼Œæ‰€æœ‰çš„å­˜å–æ–¹æ³•å‡å°è£…åœ¨ DeckStore.js é‡Œã€‚</p>

<h4>Reflux æ¶æ„</h4>

<p>ä½œè€…ä½¿ç”¨ Reflux æ¶æ„å®ç°æ•°æ®çš„å•é¡¹æµåŠ¨ï¼Œä¸»è¦çš„ä¸¤ä¸ªæ¦‚å¿µä¾¿æ˜¯ Store å’Œ Action äº†ã€‚</p>

<p>ç”¨æˆ·åœ¨ View ä¸Šæ“ä½œï¼Œè§¦å‘ Actionï¼Œç¤ºä¾‹ View çš„äº‹ä»¶å“åº”ä»£ç å¦‚ä¸‹ï¼š
<code>js
DeckActions.createDeck(deck)
</code></p>

<p>è€Œ createDeck æ˜¯åœ¨ actions.js é‡Œå®šä¹‰çš„ï¼š
<code>js
export var DeckActions = Reflux.createActions([
  'createDeck'
]);
</code></p>

<p>Store çš„ init æ–¹æ³•é‡Œç›‘å¬ Actionï¼š
<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'><span class="kd">var</span> <span class="nx">decksStore</span> <span class="o">=</span> <span class="nx">Reflux</span><span class="p">.</span><span class="nx">createStore</span><span class="p">({</span>
</span><span class='line'>  <span class="nx">init</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>    <span class="k">this</span><span class="p">.</span><span class="nx">_decks</span> <span class="o">=</span> <span class="p">[];</span>
</span><span class='line'>    <span class="c1">// &amp;hellip;</span>
</span><span class='line'>    <span class="k">this</span><span class="p">.</span><span class="nx">listenTo</span><span class="p">(</span><span class="nx">DeckActions</span><span class="p">.</span><span class="nx">createDeck</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">createDeck</span><span class="p">);</span>
</span><span class='line'>    <span class="c1">// &amp;hellip;</span>
</span><span class='line'>  <span class="p">},</span><span class="o">&lt;</span><span class="err">/p&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="nx">pre</span><span class="o">&gt;&lt;</span><span class="nx">code</span><span class="o">&gt;</span><span class="c1">// ...</span>
</span><span class='line'><span class="o">&lt;</span><span class="err">/code&gt;&lt;/pre&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="nx">p</span><span class="o">&gt;</span>  <span class="nx">createDeck</span><span class="p">(</span><span class="nx">deck</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>    <span class="k">this</span><span class="p">.</span><span class="nx">_decks</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">deck</span><span class="p">);</span><span class="o">&lt;</span><span class="err">/p&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="nx">pre</span><span class="o">&gt;&lt;</span><span class="nx">code</span><span class="o">&gt;</span><span class="k">this</span><span class="p">.</span><span class="nx">emit</span><span class="p">();</span>
</span><span class='line'><span class="o">&lt;</span><span class="err">/code&gt;&lt;/pre&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="nx">p</span><span class="o">&gt;</span>  <span class="p">}</span><span class="o">&lt;</span><span class="err">/p&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="nx">pre</span><span class="o">&gt;&lt;</span><span class="nx">code</span><span class="o">&gt;</span><span class="c1">// ...</span>
</span><span class='line'><span class="o">&lt;</span><span class="err">/code&gt;&lt;/pre&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="nx">p</span><span class="o">&gt;</span>  <span class="nx">emit</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>      <span class="c1">// &amp;hellip;</span>
</span><span class='line'>    <span class="k">this</span><span class="p">.</span><span class="nx">trigger</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">_decks</span><span class="p">);</span>
</span><span class='line'>  <span class="p">},</span>
</span><span class='line'><span class="p">});</span><span class="o">&lt;</span><span class="err">/p&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="nx">p</span><span class="o">&gt;</span><span class="nx">module</span><span class="p">.</span><span class="nx">exports</span> <span class="o">=</span> <span class="nx">decksStore</span><span class="p">;</span>
</span></code></pre></td></tr></table></div></figure></p>

<p>è¿™æ ·åœ¨ createDeck è¿™ä¸€ action è§¦å‘åï¼ŒStore å˜å›æ‰§è¡Œ createDeck æ–¹æ³•ä»¥æ›´æ–° Store ä¸­çš„æ•°æ®ï¼Œå†é€šè¿‡ emit æ–¹æ³•é€šçŸ¥å‡ºå»ã€‚</p>

<p>View é‡Œé¢ç›‘å¬ DeckStore çš„æ¶ˆæ¯ï¼Œå°†é€šçŸ¥æºå¸¦æ¥çš„æ•°æ®æ¨¡å‹å­˜åœ¨ state é‡Œä»¥è§¦å‘ render æ–¹æ³•çš„æ‰§è¡Œï¼ˆæ›´æ–° UIï¼‰ã€‚</p>

<p><img src="https://c2.staticflickr.com/6/5816/29772102074_b8ec9b3328_o.png" width="328" alt="Reflux Architecture" /></p>

<h4>é¡µé¢ç»„è£…</h4>

<p>src/components/Decks/index.js æ˜¯è¯¥é¡µé¢çš„ä¸»æ–‡ä»¶ï¼Œä¼šåŒ…å«ä¸€äº›å­ç»„ä»¶ä»¥å®Œæˆæ•´ä¸ªé¡µé¢çš„æ¸²æŸ“ã€‚</p>

<p>åœ¨ index.js çš„ render æ–¹æ³•é‡Œï¼Œå°†è¿™ä¸€æ®µä»£ç å°è£…åœ¨ä¸€ä¸ªç‹¬ç«‹çš„å·¥å…·æ–¹æ³•ï¼Œç„¶ååœ¨ render é‡Œé¢å¼•ç”¨å…¶è¿”å›çš„ UI ç»“æ„ã€‚</p>

<pre><code class="js">  _getDecks() {
    if (!this.state.decks) {
      return null;
    }

    return this.state.decks.map((deck) =&gt; {
      return (
        &lt;Deck deck={deck} .../&gt;
      );
    });
  },
</code></pre>

<p>ä½¿ç”¨é«˜é˜¶å‡½æ•° map æ ¹æ®æ¯ä¸ª deck æ•°æ®å¯¹è±¡ç”Ÿæˆå¯¹åº”çš„ Deck æ ‡ç­¾ï¼Œä½œä¸ºæ•°æ®è¿”å›ã€‚</p>

<pre><code class="js">  render() {
    return (
      &lt;View&gt;
        {this._getDecks()}
        &lt;DeckCreation .../&gt;
      &lt;/View&gt;
    );
  }
</code></pre>

<p>è¾“å…¥ Deck åæ—¶æ¯”æ­£å¸¸æƒ…å†µä¸‹å¤šä¸€è¡Œè¾“å…¥æ¡†ï¼Œæ‰€ä»¥åœ¨ DeckCreation.js ä¸­æ ¹æ®ä¸€ä¸ª state å˜é‡åˆ†åˆ«è¿”å›ä¸åŒçš„ä¸¤ä¸ªå­ç»„ä»¶ï¼šEnterDeck å’Œ CreateDeckButtonã€‚å‰è€…ç”±å…¬å…±ç»„ä»¶ Input å’Œ CreateDeckButton ç»„åˆè€Œæˆã€‚CreateDeckButton ç”±å…¬å…±ç»„ä»¶ Button å’Œ NormalText ç»„åˆè€Œæˆã€‚</p>

<p>è¯¦ç»†ä»£ç ä¸åœ¨æœ¬æ–‡ä¸­æä¾›ï¼Œä»¥æ€è·¯ä¸ºé‡ã€‚</p>

<h3>Card æ–°å»ºé¡µ</h3>

<p>æ•´ä½“è¿‡ç¨‹ç±»ä¼¼äº Decks é¡µé¢çš„æ„å»ºã€‚ä¸»è¦å°±æ˜¯åœ¨ View è§¦å‘ CardActions.createCard è¿™ä¸€ Actionï¼Œåœ¨ Card çš„ Store ä¸­ç›‘å¬ä»¥æ›´æ–°æ•°æ®é›†åˆã€‚</p>

<h3>Review äº¤äº’é¡µ</h3>

<p>æœ¬é¡µé¢æœ‰ä¸¤ç§åœºæ™¯ï¼Œè‹¥å­˜åœ¨å°šæœª Review è¿‡çš„ Card åˆ™æ˜¾ç¤ºå¯é€‰æ‹©ç­”æ¡ˆçš„ Review é¡µé¢ï¼Œå¦åˆ™æ˜¾ç¤º Review ç»“æœï¼ˆæ­£ç¡®ç‡ï¼‰ã€‚æ‰€ä»¥ src/components/Review/index.js é‡Œåˆ†ä¸¤ç§æƒ…å†µè¿”å› UI ç»“æ„ã€‚</p>

<p>é€‰æ‹©ç­”æ¡ˆçš„ UI ç»“æ„ï¼Œå…¶å°è£…åœ¨ ViewCard.js ä¸­ï¼Œåšæ³•ç±»ä¼¼äºä¹‹å‰ Decks åˆ©ç”¨ map é«˜é˜¶å‡½æ•°çš„æ–¹æ¡ˆã€‚Review è¿™ä¸€å—ç¨å¾®éš¾æ‡‚ä¸€ç‚¹çš„æ˜¯å…¶ Store é‡Œæ ¹æ®å½•å…¥çš„å¡ç‰‡æ„é€ é€‰é¡¹çš„é€»è¾‘ï¼Œä½†è¿™å…¶å®å·²ä¸æ˜¯ React Native çš„èŒƒå›´ï¼Œè€å¿ƒçš„å¤šçœ‹ä¸€ä¼šå„¿å°±å¯ä»¥æ‡‚ã€‚</p>

<h2>é—®é¢˜ä¸è§£å†³æ–¹æ¡ˆ</h2>

<h3>Decks é¡µé¢ä¸å±•ç¤ºæ¨¡æ‹Ÿæ•°æ®</h3>

<p>æˆ‘åœ¨å®Œæˆ Decks é¡µé¢çš„å±•ç¤ºæ—¶ï¼Œå°±ä¸ç­‰ Create Deck åŠŸèƒ½çš„å®ç°ï¼Œå°±å¼€å§‹æµ‹è¯•ä¸€ä¸‹é¡µé¢ã€‚æ¯”å¦‚åœ¨ components/Decks/index.js çš„ getInitialState ä¸­ç›´æ¥æ„é€ å‡ ä¸ª Deck å¯¹è±¡ã€‚ä½†æ˜¯å¹¶æ²¡æœ‰å±•ç¤ºå‡ºæ¥:[</p>

<p>åŸå› åœ¨äº Store å‘å‡ºçš„æ¶ˆæ¯ï¼Œå¯¼è‡´ View çš„ state é‡Œçš„æ•°æ®ç«‹å³è¢«ç½®ç©ºã€‚æˆ‘ä»¬å¯ä»¥ä¸´æ—¶åœ¨åŠ ä¸ªåˆ¤æ–­ï¼Œä¸ºç©ºå°±ä¸ setState({decks}) å³å¯ã€‚</p>

<h3>Review ç»“æœå±•ç¤ºé¡µå‘Šè­¦</h3>

<p>è¯¥é¡µä½¿ç”¨å…¬å…±ç»„ä»¶ NormalText å¹¶ä¼ é€’ color ç»™å®ƒï¼Œä½†ä½œè€…æä¾›çš„ NormalText ä»£ç é‡Œä½¿ç”¨çš„æ˜¯ View.propTypes.styleï¼Œåº”æ”¹ä¸º Text.propTypes.styleï¼</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[React Native ç»„ä»¶é—´æ•°æ®ä¼ é€’]]></title>
    <link href="https://linkoubian.github.io/blog/2016/10/11/rn-components-communication/"/>
    <updated>2016-10-11T11:14:48+08:00</updated>
    <id>https://linkoubian.github.io/blog/2016/10/11/rn-components-communication</id>
    <content type="html"><![CDATA[<p>åœ¨ React Native é¡¹ç›®è¯•ç‚¹è¿‡ç¨‹ä¸­ï¼Œå°è£…çš„ç»„ä»¶ä¹‹é—´éš¾å…éœ€è¦ä¼ é€’æ•°æ®ã€‚æœ¬æ–‡æ€»ç»“äº†å­ç»„ä»¶å¦‚ä½•å°†æ•°æ®ä¼ é€’åˆ°ä½¿ç”¨æ–¹ï¼Œä»¥åŠå¯¹å¼€å‘è¿‡ç¨‹ä¸­é‡åˆ°çš„ä¸€ä¸ª setState é—®é¢˜çš„æ¢ç©¶ã€‚</p>

<!--more-->


<h2>è®¾è®¡ä¸€ä¸ªå¯å®šåˆ¶çš„ç»„ä»¶</h2>

<p>å½“è®¾è®¡ä¸€ä¸ªç»„ä»¶ä¾›å›¢é˜Ÿä½¿ç”¨ï¼Œé€šå¸¸ä½¿ç”¨æ—¶éœ€è¦å‘å…¶ä¼ é€’ä¸€äº›ä¿¡æ¯ã€‚è¿™ä¸ªè¿‡ç¨‹å¯ä»¥å‚è€ƒå›½åº†èŠ‚å‰å†™çš„<a href="http://balloonsys.com/blog/2016/09/30/create-your-first-reusable-react-native-component/">åˆ›å»ºä¸€ä¸ª React Native åˆ†éš”çº¿ç»„ä»¶</a>ã€‚</p>

<p>ä¸»è¦æ€è·¯å°±æ˜¯å®šä¹‰å±æ€§ï¼ˆpropTypesï¼‰ï¼Œå¹¶æä¾›é»˜è®¤å±æ€§å€¼ï¼ˆgetDefaultPropsï¼‰ã€‚è¿™é‡Œä¸å†èµ˜è¿°ã€‚</p>

<h2>ç»„ä»¶è¿”å›æ•°æ®ç»™ä½¿ç”¨æ–¹</h2>

<h3>åº”ç”¨åœºæ™¯</h3>

<p>å‡è®¾æˆ‘ä»¬çš„æŸä¸ªé¡µé¢ P ä½¿ç”¨åˆ°å°è£…æˆ¿äº§ä¿¡æ¯çš„ houseInfo ç­‰ç»„ä»¶ï¼Œéœ€è¦åœ¨ houseInfo å¡«å†™å®Œæˆ¿æºæ€»ä»· totalPrice åèƒ½æ ¹æ®å½“å‰æ•´ä¸ªé¡µé¢ï¼ˆå«å¤šä¸ªç»„ä»¶ï¼‰çš„è¾“å…¥é¡¹å»éªŒè¯æ˜¯å¦å¯ä»¥ enable æäº¤æŒ‰é’®ï¼Œè€Œä¸”åœ¨ç‚¹å‡»æäº¤æ—¶éœ€è¦èƒ½è®¿é—®åˆ° houseInfo ç­‰ç»„ä»¶å½•å…¥çš„æ•°æ®ï¼ˆåŒ…æ‹¬ totalPrice ç­‰ï¼‰ã€‚</p>

<h3>ç»„ä»¶è®¾è®¡</h3>

<p>houseInfo ç»„ä»¶åŒ…å«è‹¥å¹²ç”± React Native æä¾›çš„ TextInput ç»„ä»¶ï¼Œåœ¨ TextInput çš„ onChangeText äº‹ä»¶ç»‘å®šæˆ‘ä»¬çš„æ–¹æ³•ï¼š</p>

<pre><code class="js">onChangeText={this._updateTotalPrice}
</code></pre>

<p>ä½¿ç”¨åˆ°çš„ _updateTotalPrice æ˜¯å®šä¹‰åœ¨è¯¥ç»„ä»¶é‡Œçš„äº‹ä»¶å“åº”æ–¹æ³•ï¼Œä½¿ç”¨æœ€ç²¾ç®€çš„å†™æ³•è®¾ç½®çŠ¶æ€æœºå˜é‡ï¼š</p>

<pre><code class="js">  _updateTotalPrice(totalPrice) {
    this.setState({totalPrice}, this._onStateUpdated);
  },
</code></pre>

<p>ç‰¹åˆ«éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œä¸Šè¿° setState æ–¹æ³•æ˜¯å¼‚æ­¥æ‰§è¡Œçš„å‡½æ•°ï¼Œå°†å˜åŒ–é€šçŸ¥åˆ°ç»„ä»¶çš„ä½¿ç”¨è€…çš„æ–¹æ³• _onStateUpdated éœ€è¦æ”¾åœ¨ setState çš„ç¬¬äºŒä¸ªå‚æ•°å¤„ï¼Œå¦åˆ™å– this.state.totalPrice ä»å°†æ˜¯æ—§å€¼ã€‚å®˜æ–¹çš„è§£é‡Šå¦‚ä¸‹ï¼š</p>

<blockquote><p>setState() does not immediately mutate this.state but creates a pending state transition. Accessing this.state after calling this method can potentially return the existing value.</p></blockquote>

<p>åœ¨å®ç° _onStateUpdated æ–¹æ³•ä¹‹å‰ï¼Œæˆ‘ä»¬å…ˆå£°æ˜ä¸€ä¸ªå‡½æ•°ç±»å‹çš„å±æ€§ï¼š</p>

<pre><code class="js">  propTypes: {
    onGetHouseInfo: React.PropTypes.func
  },
</code></pre>

<p>è¿™æ ·ä½¿ç”¨è€…å°±å¯ä»¥ä¼ é€’ä¸€ä¸ªå‡½æ•°ç»™è¯¥ç»„ä»¶ï¼Œè¯¥ç»„ä»¶åœ¨åˆé€‚çš„æ—¶æœºè°ƒç”¨æ­¤æ–¹æ³•å³å¯ä¼ é€’æ•°æ®ç»™ä½¿ç”¨æ–¹ã€‚</p>

<pre><code class="js">  _onStateUpdated() {
    this.props.onGetHouseInfo({totalPrice: this.state.totalPrice,
                                                             // å…¶ä»–è¾“å…¥é¡¹ ...
                              }, this._validate());
  },
</code></pre>

<p>æˆ‘ä»¬åœ¨ä¼ é€’è¾“å…¥çš„å€¼æ—¶ï¼Œè¿˜å°†æœ¬ç»„ä»¶çš„éªŒè¯ç»“æœä¼ é€’å‡ºå»ï¼Œè¿™æ ·ä½¿ç”¨æ–¹å³å¯ç»¼åˆå„ç»„ä»¶çš„ valid å€¼ä»¥æ§åˆ¶æäº¤æŒ‰é’®çš„çŠ¶æ€ã€‚</p>

<pre><code class="js">  _validate() {
    if (XXX) {
      return false;
    }

    return true;
  },
</code></pre>

<h3>ä½¿ç”¨æ–¹</h3>

<p>æˆ‘ä»¬åœ¨ä½¿ç”¨ houseInfo ç­‰ç»„ä»¶ render è¡¨å•é¡µé¢ Pï¼Œå‚è€ƒä»£ç å¦‚ä¸‹ï¼š</p>

<pre><code class="js">&lt;HouseInfo onGetHouseInfo={this._getHouseInfo} /&gt;
</code></pre>

<p>æ­¤å¤„çš„ _getHouseInfo ç”¨äºä»ç»„ä»¶æ¥æ”¶æ•°æ®ï¼Œä»¥å­˜æ”¾åœ¨é¡µé¢çš„ state é‡Œé¢ï¼š</p>

<pre><code class="js">  _getHouseInfo(houseInfo, houseInfoValid) {
    this.setState({houseInfo, houseInfoValid});
  },
</code></pre>

<p>è‡³äº state çš„å®šä¹‰åŠåˆå§‹åŒ–ï¼Œæ”¾åœ¨ getInitialState ä¸­å³å¯ï¼Œè¾ƒä¸ºåŸºç¡€ï¼Œæ­¤å¤„ç•¥ã€‚</p>

<h2>æ”¶å·¥</h2>

<p>ğŸ‘ğŸ‘ğŸ‘</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[åˆ›å»ºä¸€ä¸ª React Native åˆ†éš”çº¿ç»„ä»¶]]></title>
    <link href="https://linkoubian.github.io/blog/2016/09/30/create-your-first-reusable-react-native-component/"/>
    <updated>2016-09-30T10:24:06+08:00</updated>
    <id>https://linkoubian.github.io/blog/2016/09/30/create-your-first-reusable-react-native-component</id>
    <content type="html"><![CDATA[<p>åœ¨ç§»åŠ¨ç«¯è¡¨å•é¡µé¢é‡Œæœ‰ä¸å°‘åˆ†éš”çº¿ç»˜åˆ¶éœ€æ±‚ï¼Œæ„é€ ä¸€ä¸ªç»„ä»¶ä»¥åœ¨ä¸åŒé¡µé¢å¤ç”¨æ˜¯ä¸ªå¾ˆè‡ªç„¶çš„åšæ³•ã€‚</p>

<!--more-->


<h2>ç›®æ ‡</h2>

<p>æœŸæœ›åœ¨å„é¡µé¢å¯¼å…¥ require è¯¥ç»„ä»¶åï¼Œç›´æ¥ä½¿ç”¨å¦‚ä¸‹çš„æ–¹å¼ç»˜åˆ¶åˆ†éš”çº¿ï¼š</p>

<pre><code class="js">&lt;Line height={1} paddingLeft={10} paddingRight={0} backgroundColor='white' /&gt;
</code></pre>

<p>å½“ç„¶ä¹Ÿä¸ºä¸Šè¿°å››ä¸ªå±æ€§æä¾›é»˜è®¤å€¼ï¼Œå¦‚æœé»˜è®¤å€¼ç¬¦åˆéœ€æ±‚ï¼Œåˆ™åªéœ€ï¼š</p>

<pre><code class="js">&lt;Line /&gt;
</code></pre>

<h2>æ‰€éœ€æŠ€æœ¯</h2>

<h3>åˆ›å»ºç±»</h3>

<p>æˆ‘é‡‡ç”¨çš„æ˜¯ ES 5 çš„è¯­æ³•åˆ›å»ºç±»çš„ï¼Œä»£ç å¦‚ä¸‹ï¼š</p>

<pre><code class="js">let Line = React.createClass({
  render() {
    return (
    );
  },
});

module.exports = Line;
</code></pre>

<p>å…¶ä¸­ render æ–¹æ³•ç±»ä¼¼äº Native å¼€å‘ä¸­è§†å›¾çš„ç»˜åˆ¶æ–¹æ³•ã€‚æˆ‘ä»¬ç¨ååœ¨å…¶ return ä¸­åŠ ä¸Šæ„å»ºä¸ React Native åŸºç¡€ç»„ä»¶ä¹‹ä¸Šçš„ XML ä»£ç ã€‚</p>

<h3>æ·»åŠ å±æ€§</h3>

<p>æ„å»ºè¯¥åˆ†éš”çº¿ç»„ä»¶ç»™å®¢æˆ·ç¨‹åºä½¿ç”¨ï¼Œéœ€è¦è®©åˆ«äººçŸ¥é“æ”¯æŒå“ªäº›å±æ€§ï¼Œæ¯”å¦‚çº¿çš„é«˜åº¦ã€å·¦å³ç¼©è¿›ã€èƒŒæ™¯è‰²åŠçº¿çš„é¢œè‰²ç­‰ã€‚</p>

<pre><code class="js">  propTypes: {
    height: React.PropTypes.number,
    paddingLeft: React.PropTypes.number,
    paddingRight: React.PropTypes.number,
    backgroundColor: React.PropTypes.string,
    lineColor: React.PropTypes.string,
  },
</code></pre>

<p>ä¸ºäº†ç”¨èµ·æ¥æ–¹ä¾¿ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥ç»™è¿™äº›å±æ€§æä¾›é»˜è®¤å€¼ï¼š</p>

<pre><code class="js">  getDefaultProps() {
    return {
      height: 0.5,
      paddingLeft: 0,
      paddingRight: 0,
      backgroundColor: '#FFFFFF',
      lineColor: '#D3D3D3',
    }
  },
</code></pre>

<h3>ç»˜åˆ¶æ§ä»¶</h3>

<p>å…·ä½“çš„ç»˜åˆ¶ä»£ç åœ¨ render æ–¹æ³•ä¸­å®Œæˆã€‚å¦‚å‰é¢æ‰€è¿°ï¼Œæˆ‘ä»¬å°†ç”¨åˆ° React Native æä¾›çš„åŸºç¡€ç»„ä»¶ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦åœ¨ä»£ç é¡¶éƒ¨å¯¼å…¥ã€‚</p>

<pre><code class="js">import React, { Component } from 'react';
import { View } from 'react-native';
</code></pre>

<p>æ­¤æ—¶æˆ‘ä»¬å°±å¯ä»¥åœ¨ render æ–¹æ³•çš„ return è¯­å¥ä¸­åŠ ä¸Šä¸‹é¢ä»£ç ä»¥å®Œæˆåˆ†éš”çº¿çš„ç»˜åˆ¶äº†ï¼š</p>

<pre><code class="xml">      &lt;View style={} &gt;
        &lt;View style={} /&gt;
      &lt;/View&gt;
</code></pre>

<p>å¤–å±‚çš„ View çš„ style å±æ€§è®¾ç½®ä¸ºï¼š</p>

<pre><code class="js">{backgroundColor: this.props.backgroundColor, height: this.props.height, paddingLeft: this.props.paddingLeft, paddingRight: this.props.paddingRight}
</code></pre>

<p>å†…å±‚çš„ View çš„ style å±æ€§è®¾ç½®ä¸ºï¼š</p>

<pre><code class="js">{flex: 1, backgroundColor: this.props.lineColor}
</code></pre>

<h2>æ€»ç»“</h2>

<p>æœ¬æ–‡é€‰å–æœ€æœ€ç®€å•çš„åˆ†éš”çº¿ä»‹ç» React Native å®è·µè¿‡ç¨‹ä¸­çš„ä»£ç ç¼–å†™æ€è·¯ï¼Œå®Œæˆçš„å…¶ä»–æ§ä»¶æœ‰è¡¨å•å¡«å†™è¿›åº¦ç­‰ã€‚</p>
]]></content>
  </entry>
  
</feed>
