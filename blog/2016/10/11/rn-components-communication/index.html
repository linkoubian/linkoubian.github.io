
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>React Native ç»„ä»¶é—´æ•°æ®ä¼ é€’ - Balloonsys Inc.</title>
  <meta name="author" content="Linkou Bian">

  
  <meta name="description" content="åœ¨ React Native é¡¹ç›®è¯•ç‚¹è¿‡ç¨‹ä¸­ï¼Œå°è£…çš„ç»„ä»¶ä¹‹é—´éš¾å…éœ€è¦ä¼ é€’æ•°æ®ã€‚æœ¬æ–‡æ€»ç»“äº†å­ç»„ä»¶å¦‚ä½•å°†æ•°æ®ä¼ é€’åˆ°ä½¿ç”¨æ–¹ï¼Œä»¥åŠå¯¹å¼€å‘è¿‡ç¨‹ä¸­é‡åˆ°çš„ä¸€ä¸ª setState é—®é¢˜çš„æ¢ç©¶ã€‚ è®¾è®¡ä¸€ä¸ªå¯å®šåˆ¶çš„ç»„ä»¶ å½“è®¾è®¡ä¸€ä¸ªç»„ä»¶ä¾›å›¢é˜Ÿä½¿ç”¨ï¼Œé€šå¸¸ä½¿ç”¨æ—¶éœ€è¦å‘å…¶ä¼ é€’ä¸€äº›ä¿¡æ¯ã€‚è¿™ä¸ªè¿‡ç¨‹å¯ä»¥å‚è€ƒå›½åº†èŠ‚å‰å†™çš„åˆ›å»ºä¸€ä¸ª &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://balloonsys.github.io/blog/2016/10/11/rn-components-communication/">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/atom.xml" rel="alternate" title="Balloonsys Inc." type="application/atom+xml">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="/javascripts/libs/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="//fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="//fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

<script type="text/javascript">
function addBlankTargetForLinks () {
  $('a[href^="http"]').each(function(){
      $(this).attr('target', '_blank');
  });
}

$(document).bind('DOMNodeInserted', function(event) {
 addBlankTargetForLinks();
});
</script>
  

</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">Balloonsys Inc.</a></h1>
  
    <h2>Just a blog now.</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="http://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="sitesearch" value="balloonsys.github.io">
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
  <li><a href="/about">About</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div>
<article class="hentry" role="article">
  
  <header>
    
      <h1 class="entry-title">React Native ç»„ä»¶é—´æ•°æ®ä¼ é€’</h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2016-10-11T11:14:48+08:00'><span class='date'><span class='date-month'>Oct</span> <span class='date-day'>11</span><span class='date-suffix'>th</span>, <span class='date-year'>2016</span></span> <span class='time'>11:14 am</span></time>
        
           | <a href="#disqus_thread"
             data-disqus-identifier="http://balloonsys.github.io">Comments</a>
        
      </p>
    
  </header>


<div class="entry-content"><p>åœ¨ React Native é¡¹ç›®è¯•ç‚¹è¿‡ç¨‹ä¸­ï¼Œå°è£…çš„ç»„ä»¶ä¹‹é—´éš¾å…éœ€è¦ä¼ é€’æ•°æ®ã€‚æœ¬æ–‡æ€»ç»“äº†å­ç»„ä»¶å¦‚ä½•å°†æ•°æ®ä¼ é€’åˆ°ä½¿ç”¨æ–¹ï¼Œä»¥åŠå¯¹å¼€å‘è¿‡ç¨‹ä¸­é‡åˆ°çš„ä¸€ä¸ª setState é—®é¢˜çš„æ¢ç©¶ã€‚</p>

<!--more-->


<h2>è®¾è®¡ä¸€ä¸ªå¯å®šåˆ¶çš„ç»„ä»¶</h2>

<p>å½“è®¾è®¡ä¸€ä¸ªç»„ä»¶ä¾›å›¢é˜Ÿä½¿ç”¨ï¼Œé€šå¸¸ä½¿ç”¨æ—¶éœ€è¦å‘å…¶ä¼ é€’ä¸€äº›ä¿¡æ¯ã€‚è¿™ä¸ªè¿‡ç¨‹å¯ä»¥å‚è€ƒå›½åº†èŠ‚å‰å†™çš„<a href="http://balloonsys.com/blog/2016/09/30/create-your-first-reusable-react-native-component/">åˆ›å»ºä¸€ä¸ª React Native åˆ†éš”çº¿ç»„ä»¶</a>ã€‚</p>

<p>ä¸»è¦æ€è·¯å°±æ˜¯å®šä¹‰å±æ€§ï¼ˆpropTypesï¼‰ï¼Œå¹¶æä¾›é»˜è®¤å±æ€§å€¼ï¼ˆgetDefaultPropsï¼‰ã€‚è¿™é‡Œä¸å†èµ˜è¿°ã€‚</p>

<h2>ç»„ä»¶è¿”å›æ•°æ®ç»™ä½¿ç”¨æ–¹</h2>

<h3>åº”ç”¨åœºæ™¯</h3>

<p>å‡è®¾æˆ‘ä»¬çš„æŸä¸ªé¡µé¢ P ä½¿ç”¨åˆ°å°è£…æˆ¿äº§ä¿¡æ¯çš„ houseInfo ç­‰ç»„ä»¶ï¼Œéœ€è¦åœ¨ houseInfo å¡«å†™å®Œæˆ¿æºæ€»ä»· totalPrice åèƒ½æ ¹æ®å½“å‰æ•´ä¸ªé¡µé¢ï¼ˆå«å¤šä¸ªç»„ä»¶ï¼‰çš„è¾“å…¥é¡¹å»éªŒè¯æ˜¯å¦å¯ä»¥ enable æäº¤æŒ‰é’®ï¼Œè€Œä¸”åœ¨ç‚¹å‡»æäº¤æ—¶éœ€è¦èƒ½è®¿é—®åˆ° houseInfo ç­‰ç»„ä»¶å½•å…¥çš„æ•°æ®ï¼ˆåŒ…æ‹¬ totalPrice ç­‰ï¼‰ã€‚</p>

<h3>ç»„ä»¶è®¾è®¡</h3>

<p>houseInfo ç»„ä»¶åŒ…å«è‹¥å¹²ç”± React Native æä¾›çš„ TextInput ç»„ä»¶ï¼Œåœ¨ TextInput çš„ onChangeText äº‹ä»¶ç»‘å®šæˆ‘ä»¬çš„æ–¹æ³•ï¼š</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'><span class="nx">onChangeText</span><span class="o">=</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">_updateTotalPrice</span><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>ä½¿ç”¨åˆ°çš„ _updateTotalPrice æ˜¯å®šä¹‰åœ¨è¯¥ç»„ä»¶é‡Œçš„äº‹ä»¶å“åº”æ–¹æ³•ï¼Œä½¿ç”¨æœ€ç²¾ç®€çš„å†™æ³•è®¾ç½®çŠ¶æ€æœºå˜é‡ï¼š</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'>  <span class="nx">_updateTotalPrice</span><span class="p">(</span><span class="nx">totalPrice</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>    <span class="k">this</span><span class="p">.</span><span class="nx">setState</span><span class="p">({</span><span class="nx">totalPrice</span><span class="p">},</span> <span class="k">this</span><span class="p">.</span><span class="nx">_onStateUpdated</span><span class="p">);</span>
</span><span class='line'>  <span class="p">},</span>
</span></code></pre></td></tr></table></div></figure>


<p>ç‰¹åˆ«éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œä¸Šè¿° setState æ–¹æ³•æ˜¯å¼‚æ­¥æ‰§è¡Œçš„å‡½æ•°ï¼Œå°†å˜åŒ–é€šçŸ¥åˆ°ç»„ä»¶çš„ä½¿ç”¨è€…çš„æ–¹æ³• _onStateUpdated éœ€è¦æ”¾åœ¨ setState çš„ç¬¬äºŒä¸ªå‚æ•°å¤„ï¼Œå¦åˆ™å– this.state.totalPrice ä»å°†æ˜¯æ—§å€¼ã€‚å®˜æ–¹çš„è§£é‡Šå¦‚ä¸‹ï¼š</p>

<blockquote><p>setState() does not immediately mutate this.state but creates a pending state transition. Accessing this.state after calling this method can potentially return the existing value.</p></blockquote>

<p>åœ¨å®ç° _onStateUpdated æ–¹æ³•ä¹‹å‰ï¼Œæˆ‘ä»¬å…ˆå£°æ˜ä¸€ä¸ªå‡½æ•°ç±»å‹çš„å±æ€§ï¼š</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'>  <span class="nx">propTypes</span><span class="o">:</span> <span class="p">{</span>
</span><span class='line'>    <span class="nx">onGetHouseInfo</span><span class="o">:</span> <span class="nx">React</span><span class="p">.</span><span class="nx">PropTypes</span><span class="p">.</span><span class="nx">func</span>
</span><span class='line'>  <span class="p">},</span>
</span></code></pre></td></tr></table></div></figure>


<p>è¿™æ ·ä½¿ç”¨è€…å°±å¯ä»¥ä¼ é€’ä¸€ä¸ªå‡½æ•°ç»™è¯¥ç»„ä»¶ï¼Œè¯¥ç»„ä»¶åœ¨åˆé€‚çš„æ—¶æœºè°ƒç”¨æ­¤æ–¹æ³•å³å¯ä¼ é€’æ•°æ®ç»™ä½¿ç”¨æ–¹ã€‚</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'>  <span class="nx">_onStateUpdated</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>    <span class="k">this</span><span class="p">.</span><span class="nx">props</span><span class="p">.</span><span class="nx">onGetHouseInfo</span><span class="p">({</span><span class="nx">totalPrice</span><span class="o">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="p">.</span><span class="nx">totalPrice</span><span class="p">,</span>
</span><span class='line'>                                                           <span class="c1">// å…¶ä»–è¾“å…¥é¡¹ ...</span>
</span><span class='line'>                              <span class="p">},</span> <span class="k">this</span><span class="p">.</span><span class="nx">_validate</span><span class="p">());</span>
</span><span class='line'>  <span class="p">},</span>
</span></code></pre></td></tr></table></div></figure>


<p>æˆ‘ä»¬åœ¨ä¼ é€’è¾“å…¥çš„å€¼æ—¶ï¼Œè¿˜å°†æœ¬ç»„ä»¶çš„éªŒè¯ç»“æœä¼ é€’å‡ºå»ï¼Œè¿™æ ·ä½¿ç”¨æ–¹å³å¯ç»¼åˆå„ç»„ä»¶çš„ valid å€¼ä»¥æ§åˆ¶æäº¤æŒ‰é’®çš„çŠ¶æ€ã€‚</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'>  <span class="nx">_validate</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>    <span class="k">if</span> <span class="p">(</span><span class="nx">XXX</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>      <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">return</span> <span class="kc">true</span><span class="p">;</span>
</span><span class='line'>  <span class="p">},</span>
</span></code></pre></td></tr></table></div></figure>


<h3>ä½¿ç”¨æ–¹</h3>

<p>æˆ‘ä»¬åœ¨ä½¿ç”¨ houseInfo ç­‰ç»„ä»¶ render è¡¨å•é¡µé¢ Pï¼Œå‚è€ƒä»£ç å¦‚ä¸‹ï¼š</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'><span class="o">&lt;</span><span class="nx">HouseInfo</span> <span class="nx">onGetHouseInfo</span><span class="o">=</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">_getHouseInfo</span><span class="p">}</span> <span class="o">/&gt;</span>
</span></code></pre></td></tr></table></div></figure>


<p>æ­¤å¤„çš„ _getHouseInfo ç”¨äºä»ç»„ä»¶æ¥æ”¶æ•°æ®ï¼Œä»¥å­˜æ”¾åœ¨é¡µé¢çš„ state é‡Œé¢ï¼š</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'>  <span class="nx">_getHouseInfo</span><span class="p">(</span><span class="nx">houseInfo</span><span class="p">,</span> <span class="nx">houseInfoValid</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>    <span class="k">this</span><span class="p">.</span><span class="nx">setState</span><span class="p">({</span><span class="nx">houseInfo</span><span class="p">,</span> <span class="nx">houseInfoValid</span><span class="p">});</span>
</span><span class='line'>  <span class="p">},</span>
</span></code></pre></td></tr></table></div></figure>


<p>è‡³äº state çš„å®šä¹‰åŠåˆå§‹åŒ–ï¼Œæ”¾åœ¨ getInitialState ä¸­å³å¯ï¼Œè¾ƒä¸ºåŸºç¡€ï¼Œæ­¤å¤„ç•¥ã€‚</p>

<h2>æ”¶å·¥</h2>

<p>ğŸ‘ğŸ‘ğŸ‘</p>
</div>


  <footer>
    <p class="meta">
      
  

<span class="byline author vcard">Posted by <span class="fn">Linkou Bian</span></span>

      




<time class='entry-date' datetime='2016-10-11T11:14:48+08:00'><span class='date'><span class='date-month'>Oct</span> <span class='date-day'>11</span><span class='date-suffix'>th</span>, <span class='date-year'>2016</span></span> <span class='time'>11:14 am</span></time>
      

<span class="categories">
  
    <a class='category' href='/blog/categories/reactnative/'>reactnative</a>
  
</span>


    </p>
    
      <div class="sharing">
  
  
  
</div>

    
    <p class="meta">
      
        <a class="basic-alignment left" href="/blog/2016/10/09/tech-notes-21/" title="Previous Post: å¹³å®‰å¥½æˆ¿iOSå¼€å‘å›¢é˜ŸæŠ€æœ¯å‘¨æŠ¥ï¼ˆç¬¬äºŒåä¸€æœŸï¼‰">&laquo; å¹³å®‰å¥½æˆ¿iOSå¼€å‘å›¢é˜ŸæŠ€æœ¯å‘¨æŠ¥ï¼ˆç¬¬äºŒåä¸€æœŸï¼‰</a>
      
      
        <a class="basic-alignment right" href="/blog/2016/10/12/tech-notes-22/" title="Next Post: å¹³å®‰å¥½æˆ¿iOSå¼€å‘å›¢é˜ŸæŠ€æœ¯å‘¨æŠ¥ï¼ˆç¬¬äºŒåäºŒæœŸï¼‰">å¹³å®‰å¥½æˆ¿iOSå¼€å‘å›¢é˜ŸæŠ€æœ¯å‘¨æŠ¥ï¼ˆç¬¬äºŒåäºŒæœŸï¼‰ &raquo;</a>
      
    </p>
  </footer>
</article>

  <section>
    <h1>Comments</h1>
    <div id="disqus_thread" aria-live="polite"><noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>
  </section>

</div>

<aside class="sidebar">
  
    <section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2016/12/23/tech-notes-32/">å¹³å®‰å¥½æˆ¿iOSå¼€å‘å›¢é˜ŸæŠ€æœ¯å‘¨æŠ¥ï¼ˆç¬¬ä¸‰åäºŒæœŸï¼‰</a>
      </li>
    
      <li class="post">
        <a href="/blog/2016/12/16/tech-notes-31/">å¹³å®‰å¥½æˆ¿iOSå¼€å‘å›¢é˜ŸæŠ€æœ¯å‘¨æŠ¥ï¼ˆç¬¬ä¸‰åä¸€æœŸï¼‰</a>
      </li>
    
      <li class="post">
        <a href="/blog/2016/12/11/tech-notes-30/">å¹³å®‰å¥½æˆ¿iOSå¼€å‘å›¢é˜ŸæŠ€æœ¯å‘¨æŠ¥ï¼ˆç¬¬ä¸‰åæœŸï¼‰</a>
      </li>
    
      <li class="post">
        <a href="/blog/2016/12/02/tech-notes-29/">å¹³å®‰å¥½æˆ¿iOSå¼€å‘å›¢é˜ŸæŠ€æœ¯å‘¨æŠ¥ï¼ˆç¬¬äºŒåä¹æœŸï¼‰</a>
      </li>
    
      <li class="post">
        <a href="/blog/2016/11/23/tech-notes-28/">å¹³å®‰å¥½æˆ¿iOSå¼€å‘å›¢é˜ŸæŠ€æœ¯å‘¨æŠ¥ï¼ˆç¬¬äºŒåå…«æœŸï¼‰</a>
      </li>
    
      <li class="post">
        <a href="/blog/2016/11/18/tech-notes-27/">å¹³å®‰å¥½æˆ¿iOSå¼€å‘å›¢é˜ŸæŠ€æœ¯å‘¨æŠ¥ï¼ˆç¬¬äºŒåä¸ƒæœŸï¼‰</a>
      </li>
    
      <li class="post">
        <a href="/blog/2016/11/11/tech-notes-26/">å¹³å®‰å¥½æˆ¿iOSå¼€å‘å›¢é˜ŸæŠ€æœ¯å‘¨æŠ¥ï¼ˆç¬¬äºŒåå…­æœŸï¼‰</a>
      </li>
    
      <li class="post">
        <a href="/blog/2016/11/04/tech-notes-25/">å¹³å®‰å¥½æˆ¿iOSå¼€å‘å›¢é˜ŸæŠ€æœ¯å‘¨æŠ¥ï¼ˆç¬¬äºŒåäº”æœŸï¼‰</a>
      </li>
    
      <li class="post">
        <a href="/blog/2016/11/04/static-vs-dynamic-lib/">iOS é™æ€åº“åŠåŠ¨æ€åº“å¼€å‘</a>
      </li>
    
      <li class="post">
        <a href="/blog/2016/10/30/reading-in-2016/">2016 å¹´è¯»è¿‡çš„é‚£äº›ä¹¦</a>
      </li>
    
  </ul>
</section>





  
</aside>


    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2016 - Linkou Bian -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  

<script type="text/javascript">
      var disqus_shortname = 'balloonsys';
      
        
        // var disqus_developer = 1;
        var disqus_identifier = 'http://balloonsys.github.io/blog/2016/10/11/rn-components-communication/';
        var disqus_url = 'http://balloonsys.github.io/blog/2016/10/11/rn-components-communication/';
        var disqus_script = 'embed.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = '//' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>











</body>
</html>
